<Window
		xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:local="clr-namespace:DoubanFM" xmlns:core="clr-namespace:DoubanFM.Core;assembly=DoubanFM.Core"  mc:Ignorable="d" x:Class="DoubanFM.DoubanFMWindow" x:Name="Window"
		Title="豆瓣电台" Background="Transparent" SizeToContent="WidthAndHeight" ResizeMode="CanMinimize" Closed="Window_Closed" WindowStartupLocation="CenterScreen" IsVisibleChanged="Window_IsVisibleChanged" AllowsTransparency="True" WindowStyle="None" MouseLeftButtonDown="Window_MouseLeftButtonDown">
	<Window.Resources>
		<core:Player x:Key="Player"/>
		<PowerEase x:Key="Smooth" Power="3"/>
		<local:WindowBackgroundToSliderForegroundConverter x:Key="WindowBackgroundToSliderForegroundConverter"/>
		<Storyboard x:Key="BackgroundColorStoryboard">
			<ColorAnimation Storyboard.TargetName="MainGrid" Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)" Duration="0:0:5" EasingFunction="{StaticResource Smooth}"/>
		</Storyboard>
		<Storyboard x:Key="ShowCover1Storyboard">
			<DoubleAnimation Storyboard.TargetName="Cover1" Storyboard.TargetProperty="Opacity" Duration="0:0:1" To="1"/>
		</Storyboard>
		<Storyboard x:Key="ShowCover2Storyboard">
			<DoubleAnimation Storyboard.TargetName="Cover1" Storyboard.TargetProperty="Opacity" Duration="0:0:1" To="0"/>
		</Storyboard>
		<Storyboard x:Key="SlideCoverRightStoryboard">
			<ThicknessAnimation Storyboard.TargetName="CoverGrid" Storyboard.TargetProperty="Margin"
			 To="300,0,0,0" Duration="0:0:0.5" EasingFunction="{StaticResource Smooth}"/>
		</Storyboard>
        <Storyboard x:Key="SlideCoverLeftStoryboard">
			<ThicknessAnimation Storyboard.TargetName="CoverGrid" Storyboard.TargetProperty="Margin"
			 To="0,0,0,0" Duration="0:0:0.5" EasingFunction="{StaticResource Smooth}"/>
		</Storyboard>
        <Storyboard x:Key="ChangeSongInfoStoryboard">
			<DoubleAnimationUsingKeyFrames Storyboard.TargetName="SongInfoPanel" Storyboard.TargetProperty="Opacity">
				<LinearDoubleKeyFrame Value="0" KeyTime="0:0:0.3"/>
				<EasingDoubleKeyFrame Value="1" KeyTime="0:0:0.6" EasingFunction="{StaticResource Smooth}"/>
			</DoubleAnimationUsingKeyFrames>
            <StringAnimationUsingKeyFrames Storyboard.TargetName="SongTitle" Storyboard.TargetProperty="Content">
                <DiscreteStringKeyFrame KeyTime="0:0:0.3"/>
            </StringAnimationUsingKeyFrames>
            <StringAnimationUsingKeyFrames Storyboard.TargetName="Artist" Storyboard.TargetProperty="Content">
                <DiscreteStringKeyFrame KeyTime="0:0:0.3"/>
            </StringAnimationUsingKeyFrames>
            <StringAnimationUsingKeyFrames Storyboard.TargetName="Album" Storyboard.TargetProperty="Content">
                <DiscreteStringKeyFrame KeyTime="0:0:0.3"/>
            </StringAnimationUsingKeyFrames>
        </Storyboard>
		<Storyboard x:Key="DjChannelClickStoryboard">
			<ThicknessAnimation
Storyboard.TargetName="ChannelsContentGrid" Storyboard.TargetProperty="Margin" To="-750,0,0,0" Duration="0:0:0.5" EasingFunction="{StaticResource Smooth}"/>
		</Storyboard>
		<BitmapImage x:Key="PauseThumbImage">Images/DoubanFM_Pause.png</BitmapImage>
		<BitmapImage x:Key="PlayThumbImage">Images/DoubanFM_Play.png</BitmapImage>
		<BitmapImage x:Key="NextThumbImage">Images/DoubanFM_Next.png</BitmapImage>
        <BitmapImage x:Key="LikeThumbImage">Images/DoubanFM_Like_Like.png</BitmapImage>
        <BitmapImage x:Key="LikeThumbImage_Disabled">Images/DoubanFM_Like_Disabled.png</BitmapImage>
        <BitmapImage x:Key="UnlikeThumbImage">Images/DoubanFM_Like_Unlike.png</BitmapImage>
        <BitmapImage x:Key="NeverThumbImage">Images/DoubanFM_Never.png</BitmapImage>
        <BitmapImage x:Key="NeverThumbImage_Disabled">Images/DoubanFM_Never_Disabled.png</BitmapImage>
	</Window.Resources>
	<Window.TaskbarItemInfo>
		<TaskbarItemInfo>
			<TaskbarItemInfo.ThumbButtonInfos>
                <ThumbButtonInfo x:Name="LikeThumb" ImageSource="{StaticResource UnlikeThumbImage}" Click="LikeThumb_Click" />
                <ThumbButtonInfo x:Name="NeverThumb" ImageSource="{StaticResource NeverThumbImage_Disabled}" Click="NeverThumb_Click" IsEnabled="False"/>
                <ThumbButtonInfo x:Name="PauseThumb" Click="PauseThumb_Click" ImageSource="{StaticResource PauseThumbImage}" />
                <ThumbButtonInfo x:Name="NextThumb" Click="NextThumb_Click" ImageSource="{StaticResource NextThumbImage}" />
            </TaskbarItemInfo.ThumbButtonInfos>
		</TaskbarItemInfo>
	</Window.TaskbarItemInfo>
	<Grid>
		<Grid x:Name="MainGrid" Margin="15" Background="#FF4993E5">
			<Border Background="{Binding Background, ElementName=MainGrid}">
				<Border.Effect>
					<DropShadowEffect ShadowDepth="0" BlurRadius="20"/>
				</Border.Effect>
			</Border>
			<Grid x:Name="grid" Height="300">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="300" />
					<ColumnDefinition Width="300"/>
				</Grid.ColumnDefinitions>
				<Grid x:Name="LeftPanel" Background="Transparent" Panel.ZIndex="1">
					<TabControl x:Name="ControlPanel" Style="{DynamicResource ControlPaneStyle}" SelectionChanged="ControlPanel_SelectionChanged" Foreground="{Binding Background, ElementName=MainGrid}" ClipToBounds="True">
						<TabItem Header="{DynamicResource TabItemChannels}">
							<Grid x:Name="ChannelsGrid">
								<Grid.RowDefinitions>
									<RowDefinition Height="40"/>
									<RowDefinition/>
								</Grid.RowDefinitions>
								<Grid Background="#4E000000">
									<Grid.ColumnDefinitions>
										<ColumnDefinition/>
										<ColumnDefinition/>
										<ColumnDefinition/>
									</Grid.ColumnDefinitions>
									<Button x:Name="ButtonPersonal" IsEnabled="False" Margin="5" Content="私人兆赫">
										<Button.Triggers>
											<EventTrigger RoutedEvent="ButtonBase.Click">
												<BeginStoryboard>
													<Storyboard x:Name="PersonalClickStoryboard">
														<ThicknessAnimation
															Storyboard.TargetName="ChannelsContentGrid" Storyboard.TargetProperty="Margin" To="0" Duration="0:0:0.5" EasingFunction="{StaticResource Smooth}"/>
													</Storyboard>
												</BeginStoryboard>
											</EventTrigger>
										</Button.Triggers>
									</Button>
									<Button Grid.Column="1" Margin="5" Content="公共兆赫">
										<Button.Triggers>
											<EventTrigger RoutedEvent="ButtonBase.Click">
												<BeginStoryboard>
													<Storyboard x:Name="PublicClickStoryboard">
														<ThicknessAnimation
															Storyboard.TargetName="ChannelsContentGrid" Storyboard.TargetProperty="Margin" To="-250,0,0,0" Duration="0:0:0.5" EasingFunction="{StaticResource Smooth}"/>
													</Storyboard>
												</BeginStoryboard>
											</EventTrigger>
										</Button.Triggers>
									</Button>
									<Button Grid.Column="2" Margin="5" Content="DJ兆赫">
										<Button.Triggers>
											<EventTrigger RoutedEvent="ButtonBase.Click">
												<BeginStoryboard>
													<Storyboard x:Name="DjClickStoryboard">
														<ThicknessAnimation
															Storyboard.TargetName="ChannelsContentGrid" Storyboard.TargetProperty="Margin" To="-500,0,0,0" Duration="0:0:0.5" EasingFunction="{StaticResource Smooth}"/>
													</Storyboard>
												</BeginStoryboard>
											</EventTrigger>
										</Button.Triggers>
									</Button>
								</Grid>
								<Grid x:Name="ChannelsContentGrid" Grid.Row="1" Width="1000">
									<Grid.ColumnDefinitions>
										<ColumnDefinition/>
										<ColumnDefinition/>
										<ColumnDefinition/>
										<ColumnDefinition/>
									</Grid.ColumnDefinitions>
									<ListBox x:Name="PersonalChannels" SelectionChanged="PersonalChannels_SelectionChanged" Style="{DynamicResource ChannelsStyle}">
										<ListBox.ItemTemplate>
											<DataTemplate>
												<TextBlock Text="{Binding Name}" FontSize="20" TextWrapping="Wrap" Padding="10"/>	
											</DataTemplate>
										</ListBox.ItemTemplate>
										<ListBox.ItemsPanel>
											<ItemsPanelTemplate>
												<UniformGrid Margin="50"/>
											</ItemsPanelTemplate>
										</ListBox.ItemsPanel>
									</ListBox>
									<ListBox Grid.Column="1" x:Name="PublicChannels" SelectionChanged="PublicChannels_SelectionChanged" Style="{DynamicResource ChannelsStyle}">
										<ListBox.ItemTemplate>
											<DataTemplate>
												<TextBlock x:Name="TextBlockDjChannel" Text="{Binding Name}" FontSize="20" TextWrapping="Wrap" Padding="10"/>
											</DataTemplate>
										</ListBox.ItemTemplate>
									</ListBox>
									<ListBox Grid.Column="2" x:Name="DjCates" Style="{DynamicResource ChannelsStyle}" MouseLeftButtonUp="DjCates_MouseLeftButtonUp">
										<ListBox.ItemTemplate>
											<DataTemplate>
												<TextBlock Text="{Binding cate}" FontSize="20" TextWrapping="Wrap" Padding="10"/>
											</DataTemplate>
										</ListBox.ItemTemplate>
									</ListBox>
									<ListBox Grid.Column="3" x:Name="DjChannels" Style="{DynamicResource ChannelsStyle}" ItemsSource="{Binding SelectedItem.Channels, ElementName=DjCates}" SelectionChanged="DjChannels_SelectionChanged">
										<ListBox.ItemTemplate>
											<DataTemplate>
												<TextBlock Text="{Binding Name}" FontSize="20" TextWrapping="Wrap" Padding="10"/>
											</DataTemplate>
										</ListBox.ItemTemplate>
									</ListBox>
								</Grid>
							</Grid>
						</TabItem>
						<TabItem x:Name="Account" Header="{DynamicResource TabItemAccount}">
							<Grid>
								<Grid x:Name="LogOnPanel">
									<Grid Margin="20">
										<Grid.RowDefinitions>
											<RowDefinition Height="Auto"/>
											<RowDefinition Height="Auto"/>
											<RowDefinition/>
										</Grid.RowDefinitions>
										<Grid>
											<Grid.RowDefinitions>
												<RowDefinition/> 					
												<RowDefinition/> 					
												<RowDefinition Height="Auto"/> 					
												<RowDefinition Height="Auto"/> 					
											</Grid.RowDefinitions> 
											<Grid.ColumnDefinitions>
												<ColumnDefinition Width="Auto"/>
												<ColumnDefinition/>
											</Grid.ColumnDefinitions>
											<Label HorizontalAlignment="Right" VerticalAlignment="Center" Content="邮箱"/>
											<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Row="1" Content="密码"/>
											<TextBox x:Name="TbUsername" Grid.Column="1" Margin="4" Text="{Binding settings.User.Username, Source={StaticResource Player}}"/>
											<PasswordBox x:Name="PbPassword" Grid.Row="1" Grid.Column="1" Margin="4" PasswordChanged="PbPassword_PasswordChanged" />
											<Grid x:Name="CaptchaGrid" Grid.Row="2" Grid.ColumnSpan="2" Margin="0,10">
												<Grid.ColumnDefinitions>
													<ColumnDefinition Width="Auto"/>
													<ColumnDefinition/>
												</Grid.ColumnDefinitions>
												<Grid.RowDefinitions>
													<RowDefinition Height="Auto"/>
													<RowDefinition/>
												</Grid.RowDefinitions>
												<Button x:Name="ButtonRefreshCaptcha" Grid.ColumnSpan="2" Click="ButtonRefreshCaptcha_Click" Padding="0" MinHeight="40" MaxHeight="40" BorderThickness="0">
													<Image x:Name="Captcha" Stretch="Fill"/>
												</Button>
												<Label Grid.Row="1" HorizontalAlignment="Right" VerticalAlignment="Center" Content="验证码"/>
												<TextBox x:Name="CaptchaText" Grid.Row="1" Grid.Column="1" Margin="4"/>
											</Grid>
										</Grid>
										<Grid Grid.Row="1">
											<Grid.ColumnDefinitions>
												<ColumnDefinition/>
												<ColumnDefinition/>
											</Grid.ColumnDefinitions>
											<Label x:Name="LogOnFailedHint" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Hidden" Content="登录失败！"/>
											<Button Grid.Column="1" x:Name="ButtonLogOn" Margin="10" Click="ButtonLogOn_Click" IsDefault="True" Content="登录"/>
										</Grid>
										<Grid Grid.Row="2" Margin="0,20">
											<Grid.ColumnDefinitions>
												<ColumnDefinition/>
												<ColumnDefinition/>
											</Grid.ColumnDefinitions>
											<CheckBox x:Name="CheckBoxRememberPassword" VerticalAlignment="Center" HorizontalAlignment="Center" Content="记住密码" IsChecked="{Binding settings.RememberPassword, Mode=TwoWay, Source={StaticResource Player}}" />
											<CheckBox Grid.Column="1" x:Name="CheckBoxAutoLogOnNextTime" VerticalAlignment="Center" HorizontalAlignment="Center" Content="下次自动登录" IsChecked="{Binding settings.AutoLogOnNextTime, Mode=TwoWay, Source={StaticResource Player}}" />
										</Grid>
									</Grid>
								</Grid>			
								<Grid x:Name="LogOffPanel" Visibility="Hidden">
									<Grid.RowDefinitions>
										<RowDefinition/>
										<RowDefinition/>
										<RowDefinition/>
									</Grid.RowDefinitions>
									<Label Margin="10" HorizontalAlignment="Center" VerticalAlignment="Center" Content="{Binding Text, ElementName=TbUsername}"/>
									<Label Grid.Row="1" Margin="10" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="30" Content="已登录"/>
									<Button Grid.Row="2" x:Name="ButtonLogOff" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="20,5" Margin="10" Click="ButtonLogOff_Click" Content="注销"/>
								</Grid>
								<Grid x:Name="LoggingOnPanel" Visibility="Hidden">
									<Label FontSize="40" HorizontalAlignment="Center" VerticalAlignment="Center" Content="正在登录"/>
								</Grid>
								<Grid x:Name="LoggingOffPanel" Visibility="Hidden">
									<Label FontSize="40" HorizontalAlignment="Center" VerticalAlignment="Center" Content="正在注销"/>
								</Grid>
							</Grid>
						</TabItem>
						<TabItem Header="{DynamicResource TabItemSettings}">
							<Border Padding="30">
								<Grid>
									<Grid.RowDefinitions>
										<RowDefinition Height="Auto"/>
										<RowDefinition/>
										<RowDefinition/>
									</Grid.RowDefinitions>
									<local:VolumeControl x:Name="VolumeControl" IsMuted="{Binding settings.IsMuted, Mode=TwoWay, Source={StaticResource Player}}" Volume="{Binding settings.Volume, Mode=TwoWay, Source={StaticResource Player}}"/>
									<CheckBox Grid.Row="1" x:Name="CheckBoxRememberLastChannel" Content="记住上次播放的频道" IsChecked="{Binding settings.RememberLastChannel, Mode=TwoWay, Source={StaticResource Player}}" VerticalAlignment="Center" />
									<Grid Grid.Row="2">
										<Grid.RowDefinitions>
											<RowDefinition/>                    	
											<RowDefinition/>                    	
										</Grid.RowDefinitions>
										<RadioButton x:Name="RadioButtonSlideCoverWhenMouseMove" Content="当鼠标移动到封面上时滑动封面" IsChecked="{Binding settings.SlideCoverWhenMouseMove, Mode=TwoWay, Source={StaticResource Player}}" VerticalAlignment="Center"/>
										<RadioButton Grid.Row="1" x:Name="RadioButtonSlideCoverWhenClick" Content="当鼠标点击封面时滑动封面" VerticalAlignment="Center"/>
									</Grid>
								</Grid>			
							</Border>			
						</TabItem>
					</TabControl>
				</Grid>
				<Grid x:Name="RightPanel" Grid.Column="1" Background="Transparent">
					<Grid Margin="10">
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="3*"/>
							<RowDefinition/>
							<RowDefinition Height="Auto"/>
							<RowDefinition/>
						</Grid.RowDefinitions>
						<StackPanel x:Name="WindowStateControls" Orientation="Horizontal" HorizontalAlignment="Right" Height="20">
							<Button x:Name="ButtonMinimize" Click="ButtonMinimize_Click" Style="{DynamicResource MinimizeStyle}"/>
							<Border Width="10"/>
							<Button x:Name="ButtonToNotifyIcon" Click="ButtonToNotifyIcon_Click" Style="{DynamicResource ToNotifyIconStyle}"/>
							<Border Width="10"/>
							<Button x:Name="ButtonExit" Click="ButtonExit_Click" Style="{DynamicResource ExitStyle}"/>
						</StackPanel>
						<Grid x:Name="SongInfoPanel" Grid.Row="1" ClipToBounds="True">
							<Grid.RowDefinitions>
								<RowDefinition Height="50"/>
								<RowDefinition/>
								<RowDefinition/>
							</Grid.RowDefinitions>
							<Viewbox HorizontalAlignment="Left">
								<Label x:Name="SongTitle" FontSize="28" VerticalContentAlignment="Center" Content="豆瓣电台" Foreground="White"/>
							</Viewbox>
							<Viewbox Margin="0,5" Grid.Row="1" HorizontalAlignment="Left">
								<Label x:Name="Artist" FontSize="22" VerticalContentAlignment="Center" Foreground="White" />
							</Viewbox>
							<Viewbox Margin="0,5" Grid.Row="2" HorizontalAlignment="Left">
								<Label x:Name="Album" VerticalContentAlignment="Center" FontSize="22" Foreground="White" />
							</Viewbox>
						</Grid>
						<Grid Grid.Row="2">
							<Grid.ColumnDefinitions>
								<ColumnDefinition/>
								<ColumnDefinition/>
							</Grid.ColumnDefinitions>
							<Label x:Name="CurrentTime" VerticalContentAlignment="Bottom" FontSize="18" Foreground="White" Content="00:00"/>
							<Label Grid.Column="1" x:Name="TotalTime" HorizontalContentAlignment="Right" VerticalContentAlignment="Bottom" FontSize="18" Foreground="White" Content="00:00"/>
						</Grid>
						<Slider x:Name="Slider" Grid.Row="3" Margin="5,10" Style="{DynamicResource SliderStyleForProgress}" Background="#7F000000" Foreground="{Binding Background, Converter={StaticResource WindowBackgroundToSliderForegroundConverter}, ElementName=Window}"/>
						<Grid Grid.Row="4" HorizontalAlignment="Center" Height="50" VerticalAlignment="Bottom">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="38" />
								<ColumnDefinition Width="20"/>
								<ColumnDefinition Width="38" />
								<ColumnDefinition Width="20"/>
								<ColumnDefinition Width="32" />
								<ColumnDefinition Width="20"/>
								<ColumnDefinition Width="38"/>
							</Grid.ColumnDefinitions>
							<CheckBox Grid.Column="0" x:Name="CheckBoxLike" Style="{DynamicResource LikeStyle}" Click="CheckBoxLike_Click" />
							<Button Grid.Column="2" x:Name="ButtonNever" Style="{DynamicResource NeverStyle}" Click="ButtonNever_Click" IsEnabled="False" />
							<CheckBox Grid.Column="4" x:Name="CheckBoxPause" Style="{DynamicResource PauseStyle}" Checked="CheckBoxPause_Checked" Unchecked="CheckBoxPause_Unchecked"/>
							<Button Grid.Column="6" x:Name="ButtonNext" Click="ButtonNext_Click" Style="{DynamicResource NextStyle}"/>
						</Grid>
					</Grid>
				</Grid>
			</Grid>
			<Grid x:Name="CoverGrid" MouseLeftButtonUp="CoverGrid_MouseLeftButtonUp" Width="{Binding ActualWidth, ElementName=LeftPanel}" Height="{Binding ActualHeight, ElementName=LeftPanel}" HorizontalAlignment="Left" d:LayoutOverrides="HorizontalAlignment, GridBox" d:IsHidden="True" MouseMove="CoverGrid_MouseMove" MouseLeave="CoverGrid_MouseLeave">
				<MediaElement x:Name="Audio" LoadedBehavior="Manual" MediaEnded="Audio_MediaEnded" Volume="{Binding settings.Volume, Mode=TwoWay, Source={StaticResource Player}}" IsMuted="{Binding settings.IsMuted, Mode=TwoWay, Source={StaticResource Player}}" MediaFailed="Audio_MediaFailed" MediaOpened="Audio_MediaOpened" d:IsHidden="True" UnloadedBehavior="Manual" />
				<Image x:Name="Cover2" Stretch="UniformToFill"/>
				<Image x:Name="Cover1" Stretch="UniformToFill" Source="/DoubanFM;component/Images/DoubanFM_NoCover.png" />
			</Grid>
		</Grid>
	</Grid>
</Window>
